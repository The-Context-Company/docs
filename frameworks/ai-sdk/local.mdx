---
title: "Local mode"
description: "Local-first observability for Vercel AI SDK on Next.js"
---

## Overview
Local mode allows you to run The Context Company in a local-first mode. This is [100% open-source](https://github.com/The-Context-Company/observatory) and requires **no account or API key**.

This is particularly useful for development and testing purposes. However, we also offer a **free, cloud-hosted development environment** for all users.


## Setup

#### Step 1: Install dependencies

<CodeGroup>

```Title pnpm
pnpm add @contextcompany/otel @vercel/otel @opentelemetry/api
```

```Title npm
npm i @contextcompany/otel @vercel/otel @opentelemetry/api
```

</CodeGroup>

#### Step 2: Add instrumentation to Next.js

If you haven't already, add an `instrumentation.[js|ts]` file to your project, under the `app` directory. Call the `registerOTelTCC` function to instrument your AI SDK calls.

See the [Next.js Instrumentation guide](https://nextjs.org/docs/app/guides/instrumentation) for more information on instrumenting your Next.js application.

```typescript instrumentation.ts
import { registerOTelTCC } from "@contextcompany/otel/nextjs";

export function register() {
  if (process.env.NEXT_RUNTIME === "nodejs") {
    registerOTelTCC({ local: true });
  }
}
```

#### Step 3: Add widget to layout

Add the Local Mode widget to the root layout of your Next.js application.

```tsx app/layout.tsx
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <head>
        <script
          crossOrigin="anonymous"
          src="//unpkg.com/@contextcompany/widget/dist/auto.global.js"
        />
        {/* other scripts */}
      </head>
      <body>{children}</body>
    </html>
  )
}
```

#### Step 4: Enable telemetry for AI SDK calls

As of AI SDK v5, telemetry is experimental and requires the `experimental_telemetry` flag to be set to `true`. Ensure you set this flag to `true` for all AI SDK calls.

<CodeGroup>

```typescript generateText
import { generateText } from "ai";

const result = generateText({
  // ...
  experimental_telemetry: { isEnabled: true }, // required
});
```

```typescript streamText
import { streamText } from "ai";

const result = streamText({
  // ...
  experimental_telemetry: { isEnabled: true }, // required
});
```

</CodeGroup>